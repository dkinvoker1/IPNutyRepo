@if (Request.IsAuthenticated && User.IsInRole("Admin"))
{


@model IEnumerable<IPNuty.Models.Order>
{ViewBag.Title = "Zamówienia chórzystów"; } //to jest tytuł strony



<div>
    <form action="/action_page.php" method="get">
        <h2>Lista zamówień</h2>
        <p>Pamiętaj, aby przy wręczeniu nut chórzyście usunąć zamówienie z listy!</p>
        <table>
            <tr>
                <td>Numer zamówienia</td>
                <td>Zamawiający</td>
                <td>Data złożenia zamówienia</td>
                <td>Status zamówienia</td>
                <td>Nuty</td>
                <td>Usuń (gdy przekazano nuty lub gdy chcesz anulować zamówienie)</td>
            </tr>
            @foreach (var item in Model)
            {
                if (item != null)
                {
                        <tr>
                            <td>@item.OrderId</td>
                            <td>@item.SingerId.Name @item.SingerId.LastName</td>
                            <td>@item.OrderTime.ToShortDateString()</td>
                            @if(@item.Completed)
                            {
                                <td>do odbioru</td>
                            }
                            else
                            {
                                <td>niezrealizowane</td>
                            }
                            <td>@item.SheetMusicId.Author - @item.SheetMusicId.Title</td>
                            <td>
                                @Html.ActionLink("Usuń", "RemoveSingerOrder", item)
                            </td>
                        </tr>
                    
                }
                else
                {

                }
            }
        </table>
        <br />
        @Html.ActionLink("Wykonaj podsumowanie", "SumUp")
        <br />
        <br />
    </form>
</div>

<div>

    <h2>Podsumowanie - co skserować na następną próbę</h2>
    <table>
        <tr>
            <td>Autor</td>
            <td>Tytuł</td>
            <td>Akcja</td>
            <td>Zamówiona ilość</td>
        </tr>
        @* Kolejne wiersze to wartości z listy (po zaznaczeniu checkboxów). Dostępne egzemplarze pobierane są z bazy, Potrzebna ilość to różnica między nimi *@
        
        @if (ViewBag.Count != null)
        {
            var uniqueOrders = ViewBag.UniqueOrders;
            var count = ViewBag.Count;
            for (int i = 0; i <= uniqueOrders.Count - 1; i ++)
            {
                    <tr>
                        <td>@uniqueOrders[i].SheetMusicId.Author</td>
                        <td>@uniqueOrders[i].SheetMusicId.Title</td>
                        @if (@uniqueOrders[i].Completed == false)
                        {
                        <td>
                            @Html.ActionLink("Kseruj!", "ChangeOrderStatus", Model.Where(x => x.OrderId == uniqueOrders[i].OrderId).FirstOrDefault())
                        </td>
                        }
                        
                        <td>@count[i]</td>

                    </tr>
            }
        }

     </table>
    @Html.ActionLink("Wyczyść wszystko", "RemoveAllSumedUpOrder")
</div>

    }

    else
    {
        <h2>@Html.ActionLink("Zaloguj się, aby mieć dostęp do tej strony.", "Login", "Account")</h2>
    }
